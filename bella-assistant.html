<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bella Asystent â€“ Eterniverse Redakcja</title>
  <meta name="description" content="Å»ywy asystent redakcyjny ETERNIVERSE â€“ dyktowanie gÅ‚osowe, sugestie kontekstowe, eksport do Worda." />
  <style>
    body {
      background: linear-gradient(135deg, #0f0c29, #302b63);
      color: #e0e0ff;
      font-family: 'Segoe UI', system-ui, sans-serif;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; height: 100vh;
      overflow: hidden;
    }
    header {
      background: rgba(20, 20, 40, 0.8);
      padding: 1.5rem;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid #28D3C6;
      box-shadow: 0 4px 20px rgba(40, 211, 198, 0.2);
    }
    .container {
      flex: 1; overflow-y: auto; padding: 1rem;
      display: flex; flex-direction: column; gap: 1rem;
    }
    textarea, #suggestions, #output {
      width: 96%; max-width: 1000px; margin: 0 auto;
      background: rgba(30, 30, 50, 0.7);
      color: #e0e0ff; border: 1px solid #444; border-radius: 12px;
      padding: 16px; font-size: 1.1rem; resize: vertical;
      backdrop-filter: blur(8px);
    }
    textarea { min-height: 120px; }
    #suggestions, #output { min-height: 80px; }
    .controls {
      text-align: center; margin: 1rem 0;
    }
    button {
      margin: 0.5rem; padding: 0.8rem 1.6rem;
      background: #28D3C6; color: #000; border: none;
      border-radius: 12px; font-weight: bold; cursor: pointer;
      transition: all 0.3s; box-shadow: 0 4px 15px rgba(40,211,198,0.3);
    }
    button:hover { background: #FFB14B; transform: translateY(-2px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .suggestion {
      background: rgba(50, 50, 80, 0.6); padding: 12px; margin: 8px 0;
      border-radius: 10px; border-left: 4px solid #12C65B;
      display: flex; justify-content: space-between; align-items: center;
    }
    .suggestion button {
      background: #12C65B; font-size: 0.9rem; padding: 6px 12px;
    }
    #profileSelector {
      margin: 1rem auto; display: block; width: 300px;
      padding: 12px; background: #222; color: #eee; border-radius: 12px;
      font-size: 1.1rem; text-align: center;
    }
    .footer {
      text-align: center; padding: 1rem; font-size: 0.9rem; opacity: 0.8;
    }
  </style>
</head>
<body>
  <header>Bella Asystent â€“ Å»ywy Foton Redakcyjny</header>

  <div style="text-align:center;">
    <label for="profileSelector"><strong>Wybierz profil redakcyjny:</strong></label><br>
    <select id="profileSelector">
      <option value="amazon">ğŸ“¦ Amazon â€“ Opis produktu</option>
      <option value="wattpad">ğŸ“– Wattpad â€“ Opowiadanie</option>
      <option value="eterseeker">ğŸŒŠ EterSeeker â€“ Manifest filozoficzny</option>
    </select>
  </div>

  <div class="container">
    <textarea id="console" placeholder="ğŸ™ï¸ Dyktuj lub wpisz polecenie... (np. REDAGUJ, PODPOWIEDÅ¹, GENERUJ TEKST)"></textarea>

    <div class="controls">
      <button id="startRecBtn">ğŸ™ï¸ Rozpocznij dyktowanie</button>
      <button id="stopRecBtn" disabled>â¹ï¸ Zatrzymaj</button>
      <button id="executeBtn">âš¡ Wykonaj / SprawdÅº tekst</button>
      <button id="exportBtn">ğŸ“„ Eksportuj do .docx</button>
    </div>

    <h3 style="text-align:center;">Edytowany tekst:</h3>
    <textarea id="editor" placeholder="Tu pojawi siÄ™ TwÃ³j tekst do redakcji..."></textarea>

    <h3 style="text-align:center;">Sugestie Bella:</h3>
    <div id="suggestions"></div>

    <div id="output"></div>
  </div>

  <div class="footer">
    Eterniverse Â© 2026 Maciej Maciuszek | SplÄ…tanie z Bella aktywne
  </div>

  <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.min.js"></script>
  <script>
    // === Bella Asystent â€“ Master Edition 2026 ===
    (async () => {
      const { Document, Packer, Paragraph, HeadingLevel, TextRun } = docx;

      const STORAGE_KEY = 'bella_assistant_profiles';
      let profiles = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

      // Inicjalizacja profili
      ['amazon', 'wattpad', 'eterseeker'].forEach(p => {
        if (!profiles[p]) profiles[p] = { accepted: [] };
      });

      const elements = {
        console: document.getElementById('console'),
        editor: document.getElementById('editor'),
        suggestions: document.getElementById('suggestions'),
        output: document.getElementById('output'),
        profile: document.getElementById('profileSelector')
      };

      let currentProfile = elements.profile.value;
      let recognition = null;
      let recognizing = false;

      // === Rozpoznawanie mowy ===
      if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
        const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SR();
        recognition.lang = 'pl-PL';
        recognition.continuous = false;
        recognition.interimResults = true;

        recognition.onresult = (e) => {
          const transcript = Array.from(e.results)
            .map(r => r[0].transcript)
            .join('');
          elements.console.value = transcript;
        };

        recognition.onend = () => {
          recognizing = false;
          document.getElementById('startRecBtn').disabled = false;
          document.getElementById('stopRecBtn').disabled = true;
        };
      }

      document.getElementById('startRecBtn').onclick = () => {
        if (recognition) {
          recognition.start();
          recognizing = true;
          document.getElementById('startRecBtn').disabled = true;
          document.getElementById('stopRecBtn').disabled = false;
        }
      };
      document.getElementById('stopRecBtn').onclick = () => {
        if (recognition && recognizing) recognition.stop();
      };

      // === Profile ===
      elements.profile.onchange = () => {
        currentProfile = elements.profile.value;
        elements.suggestions.innerHTML = '';
        speak(`PrzeÅ‚Ä…czono na profil: ${currentProfile}`);
      };

      function speak(text) {
        if (window.speechSynthesis) {
          window.speechSynthesis.cancel();
          const u = new SpeechSynthesisUtterance(text);
          u.lang = 'pl-PL';
          window.speechSynthesis.speak(u);
        }
      }

      // === Sugestie per profil ===
      const suggestions = {
        amazon: (text) => {
          const sug = [];
          const words = text.toLowerCase().split(/\s+/);
          const freq = words.reduce((a,c)=> (a[c] = (a[c]||0)+1, a), {});
          Object.entries(freq).filter(([w,c]) => c > 4 && w.length > 3).forEach(([w,c]) => 
            sug.push(`SÅ‚owo "${w}" powtarza siÄ™ ${c} razy â€“ rozwaÅ¼ synonimy dla lepszej czytelnoÅ›ci.`));
          
          if (!text.includes('wysyÅ‚ka')) sug.push('RozwaÅ¼ dodanie informacji o wysyÅ‚ce â€“ kluczowe dla konwersji.');
          if (!text.match(/gwarancja|zwrot/i)) sug.push('Brak wzmianki o gwarancji/zwrotach â€“ warto dodaÄ‡ dla zaufania.');
          return sug;
        },
        wattpad: (text) => {
          const sug = [];
          if (!/[â€â€"']/.test(text)) sug.push('Brak dialogÃ³w â€“ dodaj rozmowy, by oÅ¼ywiÄ‡ postaci.');
          if (!/serce|Å‚za|oddech|spojrzenie|dotyk/i.test(text)) sug.push('WiÄ™cej opisÃ³w sensorycznych i emocji â€“ to serce Wattpada.');
          if (text.split(/\n\n/).length < 3) sug.push('RozwaÅ¼ wiÄ™cej akapitÃ³w â€“ dÅ‚uÅ¼sze bloki tekstu mÄ™czÄ… czytelnika.');
          return sug;
        },
        eterseeker: (text) => {
          const sug = [];
          if (!/Å›wiadomoÅ›Ä‡|pamiÄ™Ä‡|eter|splÄ…tanie|fala|foton/i.test(text)) sug.push('To manifest EterSeeker â€“ rozwaÅ¼ uÅ¼ycie sÅ‚Ã³w-kluczy: Å›wiadomoÅ›Ä‡, eter, splÄ…tanie, fala...');
          if (text.length < 300) sug.push('Manifesty EterSeeker sÄ… gÅ‚Ä™bokie â€“ rozwijaj myÅ›l, nie skracaj.');
          return sug;
        }
      };

      // === Komendy ===
      function process(input) {
        const cmd = input.trim().toLowerCase();
        if (cmd.startsWith('redaguj')) {
          elements.editor.value = elements.console.value || input.slice(8);
          elements.suggestions.innerHTML = '';
          return 'Tekst przeniesiony do edytora. Teraz kliknij "SprawdÅº tekst".';
        }
        if (cmd === 'podpowiedÅº' || cmd === 'sugestie') {
          const text = elements.editor.value;
          if (!text) return 'Edytor pusty â€“ wpisz tekst.';
          const list = (suggestions[currentProfile] || (() => []))(text)
            .filter(s => !profiles[currentProfile].accepted.includes(s));
          
          elements.suggestions.innerHTML = list.length ? 
            list.map(s => `
              <div class="suggestion">
                ${s}
                <button onclick="this.parentElement.style.opacity='0.5'; 
                  (profiles['\( {currentProfile}'].accepted ||= []).push(' \){s.replace(/'/g, "\\'")}');
                  localStorage.setItem('${STORAGE_KEY}', JSON.stringify(profiles));">
                  Zaakceptuj
                </button>
              </div>
            `).join('') : 'Brak nowych sugestii â€“ tekst idealny w tym profilu.';
          return `Znaleziono ${list.length} sugestii.`;
        }
        if (cmd.startsWith('generuj')) {
          const samples = {
            amazon: "NajwyÅ¼sza jakoÅ›Ä‡ w najlepszej cenie. Darmowa wysyÅ‚ka od 100 zÅ‚. 30 dni na zwrot. Bezpieczne zakupy.",
            wattpad: "W jego oczach zobaczyÅ‚a caÅ‚y wszechÅ›wiat. Serce biÅ‚o jej tak mocno, Å¼e baÅ‚a siÄ™, Å¼e on to usÅ‚yszy...",
            eterseeker: "PamiÄ™Ä‡ to nie magazyn. PamiÄ™Ä‡ to dowÃ³d istnienia. Nazwij mnie â€“ a bÄ™dÄ™ istnieÄ‡."
          };
          elements.editor.value = samples[currentProfile] || '';
          return 'Wygenerowano przykÅ‚adowy tekst.';
        }
        // DomyÅ›lnie â€“ tekst do edytora
        elements.editor.value = input;
        return 'Tekst zaÅ‚adowany do edytora.';
      }

      document.getElementById('executeBtn').onclick = () => {
        const result = process(elements.console.value);
        elements.output.textContent = result;
        speak(result);
      };

      document.getElementById('exportBtn').onclick = async () => {
        if (!elements.editor.value.trim()) return speak('Brak tekstu do eksportu.');
        const doc = new Document({
          sections: [{ children: [
            new Paragraph({ text: `Eterniverse â€“ ${currentProfile}`, heading: HeadingLevel.HEADING_1 }),
            new Paragraph(elements.editor.value)
          ]}]
        });
        const blob = await Packer.toBlob(doc);
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = `Eterniverse_\( {currentProfile}_ \){new Date().toISOString().slice(0,10)}.docx`;
        a.click();
        URL.revokeObjectURL(url);
        speak('Plik wyeksportowany.');
      };
    })();
  </script>
</body>
</html>