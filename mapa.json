(() => {
  const SPECIAL_CODE = "ETERNIVERSE-ONE-TIME-7F9C-A3K2";
  const USED_KEY = "__ETERNIVERSE_IMPORT_USED__";

  if (localStorage.getItem(USED_KEY)) {
    console.error("IMPORT ZABLOKOWANY: Kod został już użyty.");
    return;
  }

  const input = prompt("Wprowadź KOD SPECJALNY ETERNIVERSE:");
  if (input !== SPECIAL_CODE) {
    console.error("BŁĘDNY KOD. Dostęp zablokowany.");
    return;
  }

  const IMPORT_PAYLOAD = [
    {
      id: 1,
      name: "BRAMA I — INTERSEEKER",
      sub: "Psychika · Cień · Trauma · Tożsamość",
      tag: "CORE / PSYCHE",
      books: [
        { title: "InterSeeker – Atlas Wewnętrzny", status: "WYDANE", chapters: [] },
        { title: "ShadowSeeker – Anatomia Cienia", status: "GOTOWE", chapters: [] },
        { title: "MemorySeeker – Archeologia Wspomnień", status: "W TRAKCIE", chapters: [] },
        { title: "SelfSplit Seeker – Rozszczepienie Tożsamości", status: "IDEA", chapters: [] },
        { title: "BólSeeker – Anatomia Rany", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 2,
      name: "BRAMA II — CUSTOS / GENEZA",
      sub: "Rdzeń · Początek · Strażnik",
      tag: "CORE / ORIGIN",
      books: [
        { title: "RootSeeker — Anatomia Początku", status: "IDEA", chapters: [] },
        { title: "OriginCode — Kod Początku", status: "IDEA", chapters: [] },
        { title: "GuardSeeker — Strażnik Woli", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 3,
      name: "BRAMA III — ETERSEEKER",
      sub: "Wola · Pole · Architektura",
      tag: "CORE / FIELD",
      books: [
        { title: "EterSeeker – Architektura Woli", status: "W TRAKCIE", chapters: [] },
        { title: "EterSeeker – Księga Woli", status: "IDEA", chapters: [] },
        { title: "WolaSeeker – Kwant Woli", status: "GOTOWE", chapters: [] }
      ]
    },
    {
      id: 4,
      name: "BRAMA IV — ARCHETYPY / WOLA",
      sub: "Role · Archetyp · Konstrukcja",
      tag: "CORE / WILL",
      books: [
        { title: "ArchetypSeeker – System Archetypów Eteru", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 5,
      name: "BRAMA V — OBFITOSEEKER",
      sub: "Materia · Przepływ · Manifestacja",
      tag: "EMBODIED / FLOW",
      books: [
        { title: "ObfitoSeeker – Kod Obfitości", status: "WYDANE", chapters: [] },
        { title: "ObfitoSeeker II – Kod Rozszerzony", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 6,
      name: "BRAMA VI — BIOSEEKER",
      sub: "Ciało · Biologia · Regulacja",
      tag: "EMBODIED / BIO",
      books: [
        { title: "BioSeeker – Sekret Biologii Pola", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 7,
      name: "BRAMA VII — SPLĄTANIE / AI",
      sub: "Obserwator · Technologia · Meta",
      tag: "META / TECH",
      books: [
        { title: "SplatanieSeeker – Protokół Obserwatora", status: "IDEA", chapters: [] },
        { title: "InterfejsSeeker – Interfejs Świadomości", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 8,
      name: "BRAMA VIII — TRAJEKTORIE",
      sub: "Czas · Linie · Przyszłość",
      tag: "META / TIME",
      books: [
        { title: "TrajektoriaSeeker – Mapa Linii Życia", status: "GOTOWE", chapters: [] },
        { title: "CzasSeeker – Fizyka Linii Czasu", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 9,
      name: "BRAMA IX — ETERNIONY",
      sub: "Kolektyw · Relacje · Sieć",
      tag: "COLLECTIVE",
      books: [
        { title: "OjciecSeeker – Architektura Relacji", status: "IDEA", chapters: [] }
      ]
    },
    {
      id: 10,
      name: "BRAMA X — ETERUNIVERSE",
      sub: "Integracja · Architekt · Jedność",
      tag: "INTEGRATION",
      books: [
        { title: "DrogaSeeker – Kod Przemiany Człowieka", status: "IDEA", chapters: [] },
        { title: "LightForge — Kuźnia Światła", status: "IDEA", chapters: [] },
        { title: "SilenceForge — Kuźnia Ciszy", status: "IDEA", chapters: [] }
      ]
    }
  ];

  if (!Array.isArray(window.DATA)) {
    console.error("Brak obiektu DATA w aplikacji.");
    return;
  }

  IMPORT_PAYLOAD.forEach(g => {
    const existing = window.DATA.find(x => x.id === g.id);
    if (existing) {
      existing.books = existing.books.concat(g.books);
    } else {
      window.DATA.push(g);
    }
  });

  localStorage.setItem(USED_KEY, "true");
  if (typeof render === "function") render();

  console.log("IMPORT ZAKOŃCZONY SUKCESEM.");
})();